# テキストベース動画編集ソフト

このソフトウェアは、**LaTeX のようにテキストだけで動画編集を行う**ことができるツールです。  
動画の本文・字幕・合成音声などを、すべてテキストで記述できます。
実行には、**VoiceVox**及び**FFmpeg**が必要です。

---

## 特徴

- **コマンドなしのテキスト**は本文として扱われ、以下が自動生成されます：
  - 字幕（テキストごとに1行）
  - 合成音声（VoiceVox）
- **改行**によって、字幕および音声は分割されます。

---

## 会話モード
- 会話モードを有効化すると、空行で話者が切り替わります
- 話者の切り替わりに伴って、字幕の色も切り替わります

## コマンド一覧

### 基本設定系コマンド（文の前に記述することを推奨）

#### `\setSubtitle{size=, color=, stroke_color=, stroke_width=, color2=, stroke_color2=}`

| option | 必須 | 初期値 | 説明 |
| ---- | ---- | ---- | ---- |
| size | x | 70 | フォントのサイズを指定する |
| color | x | white | フォントの色を指定する |
| stroke_color| x | black | 文字の縁の色を指定する|
| color2 | x | white | 2人目のフォントの色を指定する |
| stroke_color2| x | black | 2人目の文字の縁の色を指定する|

- 字幕の見た目を設定します。
- 例：  
  ```text
  \setSubtitle{size=40, color=white, stroke_color=black, stroke_width=2}
  ```

#### `\setTitle{size=, color=, stroke_color=, stroke_width=}`
| option | 必須 | 初期値 | 説明 |
| ---- | ---- | ---- | ---- |
| size | x | 70 | フォントのサイズを指定する |
| color | x | white | フォントの色を指定する |
| stroke_color| x | black | 文字の縁の色を指定する|

- タイトルのスタイルを設定します。

#### `\setTalk{speed=, silence_duration=, talker1=, talker2=}`
| option | 必須 | 初期値 | 説明 |
| ---- | ---- | ---- | ---- |
|speed|x|1.2|音声スピードを指定する|
|silence_duration|x|0.5|次の字幕までの間の長さを指定する|
|talker1|x|2|メインボイスキャラクターを指定する|
|talker2|x|3|サブボイスキャラクターを指定する|
- 合成音声（VoiceVox）の設定を行います。

- キャラクターボイスの取得するサンプルとID一覧はこちらを参照 　

      https://puarts.com/?pid=1830


> ※ これらの `\set~` コマンドは途中で再設定することも可能です。

### 本文中で使うコマンド

#### `\title{text=, duration=}`

- 指定したタイトルテキストを表示します。
- 例：  
  ```text
  \title{text=はじめに, duration=3}
  ```
| option | 必須 | 初期値 | 説明 |
| ---- | ---- | ---- | ---- |
|duration|o|なし|タイトルテキストの表示時間を指定|
#### `\se{path=}`

- SE（効果音）を挿入します。
- 例：  
  ```text
  \se{path=enter.wav}
  ```

#### `\delay{duration}`
- (duration)秒の間を挿入します
- 例:
  ```text
  \delay{1.5}
  ```
| option | 必須 | 初期値 | 説明 |
| ---- | ---- | ---- | ---- |
|duration|o|なし|間の時間を指定|
### 環境コマンド（画像や特殊レイアウトに使用）

#### `\begin{環境名}[オプション]` ～ `\end{環境名}`

- 環境を使って、特定の構造（例：画像）を指定した場所に挿入できます。

#### 画像環境
- 画像を\beginから\endまで表示します
```text
\begin{image}[path=image.png,tag=cat,z=3]
~
\end{image}[tag=cat]
```
| option | 必須 | 初期値 | 説明 |
| ---- | ---- | ---- | ---- |
|tag|x|なし|タグの指定|
|z|X\x|なし|重なり順の指定(数値が大きいほうが上にくる)|
#### 画像環境(簡易版)
- tagやzのオプションを省略して記述することもできます
- tagを省略すると、直上の\beginで指定した画像を終了します
```text
\begin{image}[path=image.png]
~
\end{image}
```

#### BGM環境
- BGMを\beginから\endまで再生します
- もしBGMの長さが足らなければループ再生します
```text
\begin{bgm}[path=bgm.mp3,volume=0.2]
~
\end{bgm}
```
| option | 必須 | 初期値 | 説明 |
| ---- | ---- | ---- | ---- |
|volume|o|なし|指定したbgmの音量の指定|
---

## 使用例1

```text
\setSubtitle{size=36, color=yellow}
\setTalk{speed=1.2}

こんにちは、これはテキストベースの動画編集ソフトです。

\title{text=使い方, duration=2}

\se{path=start.wav}

次に、画像を表示してみましょう。

\begin{image}[scene.png]
この画像は説明のためのものです。
\end{image}
```

## 使用例2

```
\begin{bgm}[path=bgm2.mp3,volume=0.2]
\begin{image}[space.jpg]
\delay{1}
こんにちは。
突然ですが、みなさんは宇宙に行ってみたいと思ったことはありますか？

無重力でふわふわ漂って、地球を見下ろす――
そんな光景に憧れる人も多いかもしれませんね。

でも、ひとつ気になることがあります。
宇宙って、どんな“におい”がするんでしょう？
\delay{0.3}
「え、真空なんだから無臭じゃないの？」
そう思いますよね。私も最初はそう思っていました。

でも――実は、宇宙には“におい”があると言われているんです。
\end{image}
\begin{image}[space_walk.jpg]
\delay{1}
国際宇宙ステーションの宇宙飛行士たちによると、
船外活動から戻ってきた宇宙服や機材には、ある特有のにおいが残っているそうです。

それは――なんと、バーベキューの香り。

「焦げたステーキ」や「溶接工場のにおい」なんて言われることもあります。

実際にNASAの科学者たちが分析したところ、
そのにおいの正体は、多環芳香族炭化水素（PAHs)という化合物だと考えられています。
\end{image}
\begin{image}[pahs.png]
\delay{0.2}
これは炭素と水素が輪っか状に結合した分子で、地球上では肉を焼いたときの“香ばしい香り”としても知られています。

つまり――
宇宙はちょっと焦げたバーベキューのにおいがする、かもしれないんです。
\end{image}
\begin{image}[star.jpg]
\delay{0.2}
でも、このにおい。
実は「星の死」とも関係しているんです。

PAHsは、超新星爆発や恒星の老化によって作り出されることが多いのだそうです。

宇宙に漂うあの香ばしい成分は、言わば「星の残り香」。

そう考えると、ちょっとロマンチックですよね。
宇宙飛行士たちは、毎回バーベキューの香りをまとって帰ってくる。
それは、遠い星々からのメッセージなのかもしれません。
\end{image}
\begin{image}[earth.jpg]
\delay{0.2}

というわけで、今回は「宇宙のにおい」という、ちょっと変わった化学の雑学をご紹介しました。

宇宙は広くて謎だらけ。
でも、においという“身近な感覚”からも、いろいろなことがわかってくるんですね。

それでは、また次回の雑学でお会いしましょう。
ありがとうございました。
\delay{3}
\end{image}
\end{bgm}
```

---

## 必要な環境・依存ライブラリ

- **Python 3.10 以上**（推奨）
- 必要なパッケージは `requirements.txt` で管理されています。  
  インストール例：
  ```bash
  pip install -r requirements.txt
  ```
- **VoiceVoxエンジン**（ローカルサーバー）が必要です。  
  [VoiceVox公式サイト](https://voicevox.hiroshiba.jp/)からダウンロードし、`http://localhost:50021` でアクセスできる状態にしてください。

---

## 実行方法

1. 必要な素材（フォント・画像・音声）を `fonts/`, `images/`, `sounds/` に配置してください。
2. VoiceVoxエンジンを起動してください。
3. ソフトを起動し、入力スペースに動画のコードを入力してください。
4. 実行ボタンを押してください
5. エンコード終了後、`output/`に動画ファイルが生成されます。

---

## 注意事項・既知の制限

- VoiceVoxエンジンが起動していない場合、音声合成は失敗します。
- フォントファイルが存在しない場合、字幕やタイトルが正しく表示されません。
- Windows環境での動作を想定しています。

---

## カスタマイズ

- 設定は `tests/__init__.py` の `Config` クラスで変更できます。
- フォントやデフォルト値を編集することで、見た目や動作を調整できます。

---

## ライセンス

MIT License

---
